{"version":3,"file":"AaErrorBudgetsPage.esm.js","sources":["../../../src/components/AaErrorBudgetsPage/AaErrorBudgetsPage.tsx"],"sourcesContent":["/* eslint-disable no-console */\r\nimport { Progress } from '@backstage/core-components';\r\nimport { configApiRef, useApi } from '@backstage/core-plugin-api';\r\nimport useAsync from 'react-use/lib/useAsync';\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport { Box, Typography } from '@material-ui/core';\r\nimport {\r\n  ServicesDataResponse,\r\n  Timeperiod,\r\n} from '../../api/types';\r\nimport { agileAnalyticsApiRef } from '../../api';\r\nimport { AaErrorBudgetsServiceItem } from '../AaErrorBudgetsServiceItem';\r\n\r\nexport const AaErrorBudgetsPage = ({\r\n  timeperiod,\r\n}: {\r\n  timeperiod: Timeperiod;\r\n}) => {\r\n  const api = useApi(agileAnalyticsApiRef);\r\n  const config = useApi(configApiRef);\r\n  const orgHash = config.getString('agileAnalytics.orgHash');\r\n  const apiKey = config.getString('agileAnalytics.apiKey');\r\n\r\n  const servicesState = useAsync(async (): Promise<ServicesDataResponse> => {\r\n    const response = await api.getServicesData({\r\n      orgHash,\r\n      apiKey,\r\n    });\r\n    return response;\r\n  }, []);\r\n\r\n   const deploymentFreqState = useAsync(async (): Promise<any> => {\r\n      const response = await api.getDeploymentFreqData({\r\n        orgHash,\r\n        apiKey,\r\n        dateStart: timeperiod?.date_start,\r\n        dateEnd: timeperiod?.date_end,\r\n      });\r\n      return response;\r\n    }, [timeperiod]);\r\n\r\n  if (servicesState?.loading || deploymentFreqState?.loading) {\r\n    return <Progress />;\r\n  } else if (servicesState?.error || deploymentFreqState?.error) {\r\n    return (\r\n      <Alert severity=\"error\">\r\n        {servicesState?.error?.message\r\n          ? servicesState?.error.message\r\n          : deploymentFreqState?.error?.message}\r\n      </Alert>\r\n    );\r\n  } else if (!servicesState?.value?.length) {\r\n    return <Typography component=\"p\">No services find</Typography>;\r\n  }\r\n\r\n  return (\r\n    <Box sx={{ display: 'flex', flexDirection: 'column' }}>\r\n      {servicesState?.value?.map(item => (\r\n        <Box sx={{ marginBottom: '24px' }}>\r\n          <AaErrorBudgetsServiceItem timeperiod={timeperiod} service={item} deploymentsList={deploymentFreqState?.value}  />\r\n        </Box>\r\n      ))}\r\n    </Box>\r\n  );\r\n};\r\n"],"names":[],"mappings":";;;;;;;;;AAaO,MAAM,qBAAqB,CAAC;AAAA,EACjC;AACF,CAAA,KAEM;AACJ,EAAA,MAAM,GAAA,GAAM,OAAO,oBAAoB,CAAA;AACvC,EAAA,MAAM,MAAA,GAAS,OAAO,YAAY,CAAA;AAClC,EAAA,MAAM,OAAA,GAAU,MAAA,CAAO,SAAA,CAAU,wBAAwB,CAAA;AACzD,EAAA,MAAM,MAAA,GAAS,MAAA,CAAO,SAAA,CAAU,uBAAuB,CAAA;AAEvD,EAAA,MAAM,aAAA,GAAgB,SAAS,YAA2C;AACxE,IAAA,MAAM,QAAA,GAAW,MAAM,GAAA,CAAI,eAAA,CAAgB;AAAA,MACzC,OAAA;AAAA,MACA;AAAA,KACD,CAAA;AACD,IAAA,OAAO,QAAA;AAAA,EACT,CAAA,EAAG,EAAE,CAAA;AAEJ,EAAA,MAAM,mBAAA,GAAsB,SAAS,YAA0B;AAC5D,IAAA,MAAM,QAAA,GAAW,MAAM,GAAA,CAAI,qBAAA,CAAsB;AAAA,MAC/C,OAAA;AAAA,MACA,MAAA;AAAA,MACA,WAAW,UAAA,EAAY,UAAA;AAAA,MACvB,SAAS,UAAA,EAAY;AAAA,KACtB,CAAA;AACD,IAAA,OAAO,QAAA;AAAA,EACT,CAAA,EAAG,CAAC,UAAU,CAAC,CAAA;AAEjB,EAAA,IAAI,aAAA,EAAe,OAAA,IAAW,mBAAA,EAAqB,OAAA,EAAS;AAC1D,IAAA,2BAAQ,QAAA,EAAA,EAAS,CAAA;AAAA,EACnB,CAAA,MAAA,IAAW,aAAA,EAAe,KAAA,IAAS,mBAAA,EAAqB,KAAA,EAAO;AAC7D,IAAA,uBACE,GAAA,CAAC,KAAA,EAAA,EAAM,QAAA,EAAS,OAAA,EACb,QAAA,EAAA,aAAA,EAAe,KAAA,EAAO,OAAA,GACnB,aAAA,EAAe,KAAA,CAAM,OAAA,GACrB,mBAAA,EAAqB,KAAA,EAAO,OAAA,EAClC,CAAA;AAAA,EAEJ,CAAA,MAAA,IAAW,CAAC,aAAA,EAAe,KAAA,EAAO,MAAA,EAAQ;AACxC,IAAA,uBAAO,GAAA,CAAC,UAAA,EAAA,EAAW,SAAA,EAAU,GAAA,EAAI,QAAA,EAAA,kBAAA,EAAgB,CAAA;AAAA,EACnD;AAEA,EAAA,uBACE,GAAA,CAAC,GAAA,EAAA,EAAI,EAAA,EAAI,EAAE,OAAA,EAAS,MAAA,EAAQ,aAAA,EAAe,QAAA,EAAS,EACjD,QAAA,EAAA,aAAA,EAAe,KAAA,EAAO,GAAA,CAAI,0BACzB,GAAA,CAAC,GAAA,EAAA,EAAI,EAAA,EAAI,EAAE,YAAA,EAAc,MAAA,EAAO,EAC9B,QAAA,kBAAA,GAAA,CAAC,yBAAA,EAAA,EAA0B,UAAA,EAAwB,OAAA,EAAS,IAAA,EAAM,eAAA,EAAiB,mBAAA,EAAqB,KAAA,EAAQ,CAAA,EAClH,CACD,CAAA,EACH,CAAA;AAEJ;;;;"}