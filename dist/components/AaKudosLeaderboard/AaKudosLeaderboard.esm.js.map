{"version":3,"file":"AaKudosLeaderboard.esm.js","sources":["../../../src/components/AaKudosLeaderboard/AaKudosLeaderboard.tsx"],"sourcesContent":["/* eslint-disable no-console */\r\nimport { Select } from '@backstage/core-components';\r\nimport {\r\n  EmojiDataResponse,\r\n  OrgUsersDataResponse,\r\n  Team,\r\n  Timeperiod,\r\n  User,\r\n} from '../../api/types';\r\nimport { ListItem, List } from '@material-ui/core';\r\nimport Box from '@material-ui/core/Box';\r\nimport { Emoji } from 'emoji-picker-react';\r\nimport { Card, CardHeader, CardBody, Text } from '@backstage/ui';\r\n\r\nexport const AaKudosLeaderboard = ({\r\n  localTeamsState,\r\n  selectedTeam,\r\n  setActiveTeam,\r\n  teamsState,\r\n  users,\r\n  kudos,\r\n  kudosLeaderBoard,\r\n  timeperiod,\r\n}: {\r\n  localTeamsState: Team[];\r\n  selectedTeam: string | null;\r\n  setActiveTeam: any;\r\n  teamsState: Team[];\r\n  users: { data: OrgUsersDataResponse };\r\n  kudos: EmojiDataResponse;\r\n  kudosLeaderBoard: any;\r\n  timeperiod: Timeperiod;\r\n}) => {\r\n  const transformTeamList = () => {\r\n    const transformed = localTeamsState.map(team => {\r\n      return {\r\n        value: team.team_hash,\r\n        label: team.team_name,\r\n      };\r\n    });\r\n\r\n    return transformed?.length ? transformed : [];\r\n  };\r\n\r\n  const getSelectedTeam = () => {\r\n    const selected = transformTeamList().find(\r\n      team => team.value === selectedTeam,\r\n    );\r\n    return selected ? selected : { value: 'all', label: 'Overall' };\r\n  };\r\n\r\n  const createList = () => {\r\n    if (selectedTeam === 'all') {\r\n      const teamUsers = users?.data.map((user: User) => user.hash);\r\n\r\n      if (teamUsers.length === 0) {\r\n        return (\r\n          <li>\r\n            <p className=\"font-display text-center text-gray-500 text-xl p-4\">\r\n              No users in team\r\n            </p>\r\n          </li>\r\n        );\r\n      }\r\n\r\n      const sortedList =\r\n        kudosLeaderBoard?.team_members_list.length > 0\r\n          ? [...kudosLeaderBoard?.team_members_list]\r\n          : teamUsers.map(userHash => ({\r\n              hash: userHash,\r\n              emoji_quantity: 0,\r\n              rank: 1,\r\n            }));\r\n\r\n      return sortedList.map((userData, index) => {\r\n        return (\r\n          <LeaderbordBodyRow\r\n            emoji={kudos}\r\n            key={userData.hash}\r\n            person={users.data.find(user => user.hash === userData.hash)}\r\n            rank={userData.rank}\r\n            emojiQuantity={userData.emoji_quantity}\r\n            usersList={sortedList}\r\n            index={index}\r\n          />\r\n        );\r\n      });\r\n    }\r\n\r\n    const currentTeam = localTeamsState.find(\r\n      team => team.team_hash === selectedTeam,\r\n    );\r\n\r\n    if (currentTeam) {\r\n      const teamUsers = currentTeam?.users_in_team;\r\n\r\n      if (\r\n        teamUsers.length === 0 ||\r\n        (teamUsers.length === 1 && teamUsers[0] === '')\r\n      ) {\r\n        return (\r\n          <li className=\"flex-grow\">\r\n            <p className=\"font-display text-center text-gray-500 text-xl p-4\">\r\n              No users in team\r\n            </p>\r\n          </li>\r\n        );\r\n      }\r\n\r\n      const sortedList =\r\n        kudosLeaderBoard?.team_members_list.length > 0\r\n          ? [...kudosLeaderBoard?.team_members_list]\r\n          : teamUsers.map(userHash => ({\r\n              hash: userHash,\r\n              emoji_quantity: 0,\r\n              rank: 1,\r\n            }));\r\n\r\n      return sortedList.map((userData, index) => {\r\n        return (\r\n          <LeaderbordBodyRow\r\n            emoji={kudos}\r\n            key={userData.hash}\r\n            person={users.data.find(user => user.hash === userData.hash)}\r\n            rank={userData.rank}\r\n            usersList={sortedList}\r\n            emojiQuantity={userData.emoji_quantity}\r\n            index={index}\r\n          />\r\n        );\r\n      });\r\n    }\r\n    return null;\r\n  };\r\n\r\n  if (localTeamsState.length === 1) {\r\n    return (\r\n      <div className=\"flex justify-between items-center\">\r\n        <p>{localTeamsState[0].team_name}</p>\r\n        <p className=\"inline-block py-2 px-4 border border-solid border-gray-300 rounded font-display text-gray-600\">\r\n          {localTeamsState[0].team_name}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const selectedValue = getSelectedTeam();\r\n\r\n  return (\r\n    <Card style={{ height: '100%' }}>\r\n      <CardHeader>\r\n        <Text variant=\"title-medium\" weight=\"bold\">\r\n          Leaderboard\r\n        </Text>\r\n        <Box>\r\n          <Box sx={{ minWidth: '260px' }}>\r\n            {localTeamsState?.length === 1 ? (\r\n              <p className=\"inline-block py-2 px-4 border border-solid border-gray-300 rounded font-display text-gray-600\">\r\n                {localTeamsState[0].team_name}\r\n              </p>\r\n            ) : (\r\n              <Select\r\n                items={transformTeamList()}\r\n                selected={selectedValue?.value}\r\n                onChange={event => setActiveTeam(event)}\r\n                label=\"Selected Team\"\r\n              />\r\n            )}\r\n          </Box>\r\n        </Box>\r\n      </CardHeader>\r\n      <CardBody>\r\n        <Box sx={{ maxHeight: '360px', overflow: 'auto' }}>\r\n          <List>{createList()}</List>\r\n        </Box>\r\n      </CardBody>\r\n    </Card>\r\n  );\r\n};\r\n\r\nfunction LeaderbordBodyRow({\r\n  person,\r\n  rank,\r\n  usersList,\r\n  emoji,\r\n  emojiQuantity,\r\n  index,\r\n}: {\r\n  person: User | undefined;\r\n  rank: number;\r\n  usersList: User[];\r\n  emoji: EmojiDataResponse;\r\n  emojiQuantity: number;\r\n  index: number;\r\n}) {\r\n  const getRank = (title?: string) => {\r\n    if (index !== 0) {\r\n      const prevRank = usersList[index - 1].rank;\r\n\r\n      if (rank === prevRank || emojiQuantity === 0) return '';\r\n\r\n      if (title) {\r\n        return rank;\r\n      }\r\n      return `${rank}.`;\r\n    }\r\n    return rank;\r\n  };\r\n\r\n    const outerBoxStyle = {\r\n      display: 'flex',\r\n      justifyContent: 'space-between',\r\n      alignItems: 'center',\r\n      width: '100%',\r\n      fontWeight: 600,\r\n      fontSize: '18px',\r\n      gap: '32px',\r\n  } as const;\r\n  \r\n  const innerBoxStyle = {\r\n    display: 'flex',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    gap: '32px',\r\n  } as const;\r\n\r\n  const xsStyle = {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    gap: '8px',\r\n  } as const;\r\n\r\n\r\n  return (\r\n    <ListItem\r\n      className={`rank rank-${rank ? getRank('title') : +index + 1}`}\r\n      divider\r\n    >\r\n      <Box sx={outerBoxStyle}>\r\n        <Box sx={innerBoxStyle}>\r\n          <p>{rank ? getRank() : `${+index + 1}.`}</p>\r\n          <Box sx={xsStyle}>\r\n            <Box\r\n              sx={{\r\n                width: '40px',\r\n                height: '40px',\r\n                borderRadius: '100%',\r\n                overflow: 'hidden',\r\n                position: 'relative',\r\n              }}\r\n            >\r\n              <img src={person?.photo} alt=\"User\" className=\"userpic-kudos\" />\r\n            </Box>\r\n\r\n            <p>{person?.user_name ? person.user_name : person?.email}</p>\r\n          </Box>\r\n        </Box>\r\n        <Box className=\"gap-8\" sx={xsStyle}>\r\n          <p>{emojiQuantity}</p>\r\n          <div className=\"flex items-center\">\r\n            {emoji.map(emojiItem => {\r\n              if (emojiItem?.imgUrl) {\r\n                return (\r\n                  <img\r\n                    src={emojiItem?.imgUrl}\r\n                    alt={emojiItem?.shortcode}\r\n                    key={emojiItem?.codepoint}\r\n                    style={{ width: '16px', height: '16px' }}\r\n                  />\r\n                );\r\n              }\r\n              return (\r\n                <Emoji\r\n                  unified={emojiItem.codepoint}\r\n                  size={16}\r\n                  key={emojiItem?.codepoint}\r\n                />\r\n              );\r\n            })}\r\n          </div>\r\n        </Box>\r\n      </Box>\r\n    </ListItem>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}