{"version":3,"file":"AaLeaksPage.esm.js","sources":["../../../src/components/AaLeaksPage/AaLeaksPage.tsx"],"sourcesContent":["/* eslint-disable no-console */\r\nimport React from 'react';\r\nimport moment from 'moment';\r\nimport { GaugeCard, InfoCard, Progress } from '@backstage/core-components';\r\nimport { configApiRef, useApi } from '@backstage/core-plugin-api';\r\nimport useAsync from 'react-use/lib/useAsync';\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport { Grid } from '@material-ui/core';\r\nimport { LeaksStatisticsItem, Timeperiod } from '../../api/types';\r\nimport { agileAnalyticsApiRef } from '../../api';\r\nimport { AaDoraChart } from '../AaDoraChart';\r\n\r\nexport const AaLeaksPage = ({ timeperiod }: { timeperiod: Timeperiod }) => {\r\n  const api = useApi(agileAnalyticsApiRef);\r\n  const config = useApi(configApiRef);\r\n  const orgHash = config.getString('agileAnalytics.orgHash');\r\n  const apiKey = config.getString('agileAnalytics.apiKey');\r\n\r\n  const leaksState = useAsync(async (): Promise<any> => {\r\n    const response = await api.getLeaksData({\r\n      orgHash,\r\n      apiKey,\r\n      dateStart: timeperiod?.date_start,\r\n      dateEnd: timeperiod?.date_end,\r\n    });\r\n    return response;\r\n  }, [timeperiod]);\r\n\r\n  const chartOptions = [\r\n    {\r\n      series: [\r\n        {\r\n          name: 'All leakes',\r\n          data: leaksState?.value?.statistics?.length\r\n            ? leaksState.value.statistics.map((item: LeaksStatisticsItem) => {\r\n                return [moment(item.date).unix() * 1000, item.leaks_quantity];\r\n              })\r\n            : [],\r\n        },\r\n        {\r\n          name: 'Solved',\r\n          data: leaksState?.value?.statistics?.length\r\n            ? leaksState.value.statistics.map((item: LeaksStatisticsItem) => {\r\n                return [moment(item.date).unix() * 1000, item.leaks_fixed];\r\n              })\r\n            : [],\r\n        },\r\n      ],\r\n    },\r\n  ];\r\n\r\n  if (leaksState?.loading) {\r\n    return <Progress />;\r\n  } else if (leaksState?.error) {\r\n    return <Alert severity=\"error\">{leaksState?.error.message}</Alert>;\r\n  }\r\n\r\n  return (\r\n    <Grid container spacing={2}>\r\n      <Grid item xs={12}>\r\n        <InfoCard\r\n          title=\"Leaks\"\r\n          deepLink={{\r\n            title: 'Go to Agile Analytics to see a detailed report  ',\r\n            link: 'https://www.prod.agileanalytics.cloud/leaks',\r\n          }}\r\n        >\r\n          <AaDoraChart\r\n            timeperiod={timeperiod}\r\n            charts={chartOptions}\r\n            chartColor={['#FF6384', '#15A2BB']}\r\n            loading={leaksState.loading}\r\n            customPointFormatter={null}\r\n            customOptions={null}\r\n            yAxisFormatter={null}\r\n            yAxisTitle=\"Leaks amount\"\r\n            customOpacity={1}\r\n            isMarker={false}\r\n            isStacking={false}\r\n          />\r\n        </InfoCard>\r\n      </Grid>\r\n    </Grid>\r\n  );\r\n};\r\n"],"names":[],"mappings":"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"}