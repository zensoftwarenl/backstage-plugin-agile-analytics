{"version":3,"file":"AaSprintInsightsPage.esm.js","sources":["../../../src/components/AaSprintInsightsPage/AaSprintInsightsPage.tsx"],"sourcesContent":["/* eslint-disable no-console */\r\nimport React from 'react';\r\nimport { GaugeCard, InfoCard, Progress } from '@backstage/core-components';\r\nimport { configApiRef, useApi } from '@backstage/core-plugin-api';\r\nimport useAsync from 'react-use/lib/useAsync';\r\nimport Alert from '@material-ui/lab/Alert';\r\nimport { Grid } from '@material-ui/core';\r\nimport { Timeperiod } from '../../api/types';\r\nimport { agileAnalyticsApiRef } from '../../api';\r\nimport { AaSprintInsightsTable } from '../AaSprintInsightsTable';\r\n\r\nexport const AaSprintInsightsPage = ({\r\n  timeperiod,\r\n}: {\r\n  timeperiod: Timeperiod;\r\n}) => {\r\n  const api = useApi(agileAnalyticsApiRef);\r\n  const config = useApi(configApiRef);\r\n  const orgHash = config.getString('agileAnalytics.orgHash');\r\n  const apiKey = config.getString('agileAnalytics.apiKey');\r\n\r\n  const siState = useAsync(async (): Promise<any> => {\r\n    const response = await api.getSiData({\r\n      orgHash,\r\n      apiKey,\r\n      dateStart: timeperiod?.date_start,\r\n      dateEnd: timeperiod?.date_end,\r\n    });\r\n    return response;\r\n  }, [timeperiod]);\r\n\r\n  if (siState?.loading) {\r\n    return <Progress />;\r\n  } else if (siState?.error) {\r\n    return <Alert severity=\"error\">{siState?.error.message}</Alert>;\r\n  }\r\n\r\n  const ticketsTotal: number =\r\n    siState.value.featuresAmount + siState.value.notFeaturesAmount;\r\n  const featuresPart = siState.value.featuresAmount / ticketsTotal;\r\n  const notFeaturesPart = siState.value.notFeaturesAmount / ticketsTotal;\r\n\r\n  const timeTotal: number =\r\n    siState.value.featuresTime + siState.value.notFeaturesTime;\r\n  const featuresTimePart = siState.value.featuresTime / timeTotal;\r\n  const notFeaturesTimePart = siState.value.notFeaturesTime / timeTotal;\r\n\r\n  return (\r\n    <Grid container spacing={2}>\r\n      <Grid item>\r\n        <InfoCard\r\n          title=\"Feature - not feature\"\r\n          subheader=\"How many features and not-feature tasks are in development\"\r\n        >\r\n          <Grid container spacing={2}>\r\n            <Grid item>\r\n              <GaugeCard\r\n                title=\"Features\"\r\n                progress={featuresPart}\r\n                description={`${siState.value.featuresAmount} tickets`}\r\n              />\r\n            </Grid>\r\n\r\n            <Grid item>\r\n              <GaugeCard\r\n                title=\"Not features\"\r\n                progress={notFeaturesPart}\r\n                description={`${siState.value.notFeaturesAmount} tickets`}\r\n              />\r\n            </Grid>\r\n          </Grid>\r\n        </InfoCard>\r\n      </Grid>\r\n      <Grid item>\r\n        <InfoCard\r\n          title=\"Time spent\"\r\n          subheader=\"How much time were spent on features and not-feature tasks\"\r\n        >\r\n          <Grid container spacing={2}>\r\n            <Grid item>\r\n              <GaugeCard\r\n                title=\"Features\"\r\n                progress={featuresTimePart}\r\n                description={`${siState.value.featuresTime} hours spent`}\r\n              />\r\n            </Grid>\r\n\r\n            <Grid item>\r\n              <GaugeCard\r\n                title=\"Not features\"\r\n                progress={notFeaturesTimePart}\r\n                description={`${siState.value.notFeaturesTime} hours spent`}\r\n              />\r\n            </Grid>\r\n          </Grid>\r\n        </InfoCard>\r\n      </Grid>\r\n      <AaSprintInsightsTable\r\n        timeperiod={timeperiod}\r\n        tickets={siState.value.tickets}\r\n      />\r\n    </Grid>\r\n  );\r\n};\r\n"],"names":[],"mappings":";;;;;;;;;AAWO,MAAM,uBAAuB,CAAC;AAAA,EACnC;AACF,CAAA,KAEM;AACJ,EAAA,MAAM,GAAA,GAAM,OAAO,oBAAoB,CAAA;AACvC,EAAA,MAAM,MAAA,GAAS,OAAO,YAAY,CAAA;AAClC,EAAA,MAAM,OAAA,GAAU,MAAA,CAAO,SAAA,CAAU,wBAAwB,CAAA;AACzD,EAAA,MAAM,MAAA,GAAS,MAAA,CAAO,SAAA,CAAU,uBAAuB,CAAA;AAEvD,EAAA,MAAM,OAAA,GAAU,SAAS,YAA0B;AACjD,IAAA,MAAM,QAAA,GAAW,MAAM,GAAA,CAAI,SAAA,CAAU;AAAA,MACnC,OAAA;AAAA,MACA,MAAA;AAAA,MACA,WAAW,UAAA,EAAY,UAAA;AAAA,MACvB,SAAS,UAAA,EAAY;AAAA,KACtB,CAAA;AACD,IAAA,OAAO,QAAA;AAAA,EACT,CAAA,EAAG,CAAC,UAAU,CAAC,CAAA;AAEf,EAAA,IAAI,SAAS,OAAA,EAAS;AACpB,IAAA,2BAAQ,QAAA,EAAA,EAAS,CAAA;AAAA,EACnB,CAAA,MAAA,IAAW,SAAS,KAAA,EAAO;AACzB,IAAA,2BAAQ,KAAA,EAAA,EAAM,QAAA,EAAS,OAAA,EAAS,QAAA,EAAA,OAAA,EAAS,MAAM,OAAA,EAAQ,CAAA;AAAA,EACzD;AAEA,EAAA,MAAM,YAAA,GACJ,OAAA,CAAQ,KAAA,CAAM,cAAA,GAAiB,QAAQ,KAAA,CAAM,iBAAA;AAC/C,EAAA,MAAM,YAAA,GAAe,OAAA,CAAQ,KAAA,CAAM,cAAA,GAAiB,YAAA;AACpD,EAAA,MAAM,eAAA,GAAkB,OAAA,CAAQ,KAAA,CAAM,iBAAA,GAAoB,YAAA;AAE1D,EAAA,MAAM,SAAA,GACJ,OAAA,CAAQ,KAAA,CAAM,YAAA,GAAe,QAAQ,KAAA,CAAM,eAAA;AAC7C,EAAA,MAAM,gBAAA,GAAmB,OAAA,CAAQ,KAAA,CAAM,YAAA,GAAe,SAAA;AACtD,EAAA,MAAM,mBAAA,GAAsB,OAAA,CAAQ,KAAA,CAAM,eAAA,GAAkB,SAAA;AAE5D,EAAA,uBACE,IAAA,CAAC,IAAA,EAAA,EAAK,SAAA,EAAS,IAAA,EAAC,SAAS,CAAA,EACvB,QAAA,EAAA;AAAA,oBAAA,GAAA,CAAC,IAAA,EAAA,EAAK,MAAI,IAAA,EACR,QAAA,kBAAA,GAAA;AAAA,MAAC,QAAA;AAAA,MAAA;AAAA,QACC,KAAA,EAAM,uBAAA;AAAA,QACN,SAAA,EAAU,4DAAA;AAAA,QAEV,QAAA,kBAAA,IAAA,CAAC,IAAA,EAAA,EAAK,SAAA,EAAS,IAAA,EAAC,SAAS,CAAA,EACvB,QAAA,EAAA;AAAA,0BAAA,GAAA,CAAC,IAAA,EAAA,EAAK,MAAI,IAAA,EACR,QAAA,kBAAA,GAAA;AAAA,YAAC,SAAA;AAAA,YAAA;AAAA,cACC,KAAA,EAAM,UAAA;AAAA,cACN,QAAA,EAAU,YAAA;AAAA,cACV,WAAA,EAAa,CAAA,EAAG,OAAA,CAAQ,KAAA,CAAM,cAAc,CAAA,QAAA;AAAA;AAAA,WAC9C,EACF,CAAA;AAAA,0BAEA,GAAA,CAAC,IAAA,EAAA,EAAK,IAAA,EAAI,IAAA,EACR,QAAA,kBAAA,GAAA;AAAA,YAAC,SAAA;AAAA,YAAA;AAAA,cACC,KAAA,EAAM,cAAA;AAAA,cACN,QAAA,EAAU,eAAA;AAAA,cACV,WAAA,EAAa,CAAA,EAAG,OAAA,CAAQ,KAAA,CAAM,iBAAiB,CAAA,QAAA;AAAA;AAAA,WACjD,EACF;AAAA,SAAA,EACF;AAAA;AAAA,KACF,EACF,CAAA;AAAA,oBACA,GAAA,CAAC,IAAA,EAAA,EAAK,IAAA,EAAI,IAAA,EACR,QAAA,kBAAA,GAAA;AAAA,MAAC,QAAA;AAAA,MAAA;AAAA,QACC,KAAA,EAAM,YAAA;AAAA,QACN,SAAA,EAAU,4DAAA;AAAA,QAEV,QAAA,kBAAA,IAAA,CAAC,IAAA,EAAA,EAAK,SAAA,EAAS,IAAA,EAAC,SAAS,CAAA,EACvB,QAAA,EAAA;AAAA,0BAAA,GAAA,CAAC,IAAA,EAAA,EAAK,MAAI,IAAA,EACR,QAAA,kBAAA,GAAA;AAAA,YAAC,SAAA;AAAA,YAAA;AAAA,cACC,KAAA,EAAM,UAAA;AAAA,cACN,QAAA,EAAU,gBAAA;AAAA,cACV,WAAA,EAAa,CAAA,EAAG,OAAA,CAAQ,KAAA,CAAM,YAAY,CAAA,YAAA;AAAA;AAAA,WAC5C,EACF,CAAA;AAAA,0BAEA,GAAA,CAAC,IAAA,EAAA,EAAK,IAAA,EAAI,IAAA,EACR,QAAA,kBAAA,GAAA;AAAA,YAAC,SAAA;AAAA,YAAA;AAAA,cACC,KAAA,EAAM,cAAA;AAAA,cACN,QAAA,EAAU,mBAAA;AAAA,cACV,WAAA,EAAa,CAAA,EAAG,OAAA,CAAQ,KAAA,CAAM,eAAe,CAAA,YAAA;AAAA;AAAA,WAC/C,EACF;AAAA,SAAA,EACF;AAAA;AAAA,KACF,EACF,CAAA;AAAA,oBACA,GAAA;AAAA,MAAC,qBAAA;AAAA,MAAA;AAAA,QACC,UAAA;AAAA,QACA,OAAA,EAAS,QAAQ,KAAA,CAAM;AAAA;AAAA;AACzB,GAAA,EACF,CAAA;AAEJ;;;;"}